<!DOCTYPE html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FuelCalc - –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∏—Ç—Ä–∞—Ç –ø–∞–ª–∏–≤–∞</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        color: white;
        padding: 30px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        margin-bottom: 10px;
      }

      .header p {
        opacity: 0.9;
        font-size: 1.1rem;
      }

      .main-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        padding: 30px;
      }

      .form-section {
        background: white;
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }

      .map-section {
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      }

      .form-group {
        margin-bottom: 20px;
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #2c3e50;
        font-size: 0.95rem;
      }

      input,
      select {
        width: 100%;
        padding: 12px;
        border: 2px solid #e1e8ed;
        border-radius: 10px;
        font-size: 1rem;
        transition: all 0.3s ease;
      }

      input:focus,
      select:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .location-inputs {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 10px;
        align-items: end;
      }

      .btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 12px 20px;
        border-radius: 10px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .btn-small {
        padding: 8px 12px;
        font-size: 0.9rem;
        white-space: nowrap;
      }

      #map {
        height: 400px;
        width: 100%;
      }

      .fuel-consumption-group {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 15px;
        align-items: end;
      }

      .results {
        background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        color: white;
        padding: 20px;
        border-radius: 15px;
        margin-top: 20px;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.5s ease;
      }

      .results.show {
        opacity: 1;
        transform: translateY(0);
      }

      .results h3 {
        margin-bottom: 15px;
        font-size: 1.3rem;
      }

      .result-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 8px;
        padding-bottom: 8px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
      }

      .result-item:last-child {
        border-bottom: none;
        margin-bottom: 0;
      }

      .loading {
        text-align: center;
        padding: 20px;
        color: #666;
      }

      .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #667eea;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
        margin: 0 auto 10px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .error {
        background: #e74c3c;
        color: white;
        padding: 15px;
        border-radius: 10px;
        margin-top: 15px;
      }

      .checkbox-group {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 10px;
      }

      .checkbox-group input[type="checkbox"] {
        width: auto;
      }

      #searchBtn {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border: 2px solid #e1e8ed;
        border-top: none;
        border-radius: 0 0 10px 10px;
        max-height: 200px;
        overflow-y: auto;
        z-index: 1000;
        display: none;
      }

      .suggestion-item {
        padding: 12px;
        cursor: pointer;
        border-bottom: 1px solid #f1f1f1;
        transition: background-color 0.2s ease;
      }

      .suggestion-item:hover {
        background-color: #f8f9fa;
      }

      .suggestion-item:last-child {
        border-bottom: none;
      }

      .suggestion-main {
        font-weight: 600;
        color: #2c3e50;
      }

      .suggestion-details {
        font-size: 0.85rem;
        color: #666;
        margin-top: 2px;
      }
      .main-content {
        grid-template-columns: 1fr;
        gap: 20px;
        padding: 20px;
      }

      .header {
        padding: 20px;
      }

      .header h1 {
        font-size: 2rem;
      }

      .location-inputs {
        grid-template-columns: 1fr;
      }

      .fuel-consumption-group {
        grid-template-columns: 1fr;
      }

      #map {
        height: 300px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>‚õΩ FuelCalc</h1>
        <p>–†–æ–∑—Ä–∞—Ö—É–π—Ç–µ –≤–∏—Ç—Ä–∞—Ç–∏ –ø–∞–ª–∏–≤–∞ –¥–ª—è –≤–∞—à–æ—ó –ø–æ–¥–æ—Ä–æ–∂—ñ</p>
      </div>

      <div class="main-content">
        <div class="form-section">
          <h2>üìç –ú–∞—Ä—à—Ä—É—Ç</h2>

          <div class="form-group">
            <label for="from">–ó–≤—ñ–¥–∫–∏:</label>
            <div class="location-inputs">
              <input
                type="text"
                id="from"
                placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤—É —Ç–æ—á–∫—É"
              />
              <button
                class="btn btn-small"
                onclick="getCurrentLocation('from')"
              >
                üìç
              </button>
            </div>
          </div>

          <div class="form-group">
            <label for="to">–ö—É–¥–∏:</label>
            <input type="text" id="to" placeholder="–í–≤–µ–¥—ñ—Ç—å –∫—ñ–Ω—Ü–µ–≤—É —Ç–æ—á–∫—É" />
          </div>

          <h2 style="margin-top: 30px">üöó –ê–≤—Ç–æ–º–æ–±—ñ–ª—å</h2>

          <div class="form-group">
            <label for="carModel"
              >–ú–∞—Ä–∫–∞ —Ç–∞ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–æ–±—ñ–ª—è (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ):</label
            >
            <div style="position: relative">
              <input
                type="text"
                id="carModel"
                placeholder="–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–æ—à—É–∫ –≤–∏—Ç—Ä–∞—Ç–∏ –∞–±–æ –∑–∞–ª–∏—à—Ç–µ –ø–æ—Ä–æ–∂–Ω—ñ–º"
                autocomplete="off"
              />
              <div id="carSuggestions" class="suggestions-dropdown"></div>
            </div>
          </div>

          <div class="form-group">
            <label for="fuelConsumption">–í–∏—Ç—Ä–∞—Ç–∞ –ø–∞–ª–∏–≤–∞ (–ª/100–∫–º):</label>
            <div class="fuel-consumption-group">
              <input
                type="number"
                id="fuelConsumption"
                step="0.1"
                min="1"
                max="50"
                placeholder="–í–≤–µ–¥—ñ—Ç—å —Å–≤–æ—é —Ä–µ–∞–ª—å–Ω—É –≤–∏—Ç—Ä–∞—Ç—É"
              />
              <button
                class="btn btn-small"
                onclick="searchCarData()"
                id="searchBtn"
              >
                üîç –ó–Ω–∞–π—Ç–∏
              </button>
            </div>
          </div>

          <div class="form-group">
            <label for="fuelPrice">–¶—ñ–Ω–∞ –ø–∞–ª–∏–≤–∞ (–≥—Ä–Ω/–ª):</label>
            <input
              type="number"
              id="fuelPrice"
              step="0.01"
              min="0"
              value="52.50"
              placeholder="52.50"
            />
          </div>

          <div class="checkbox-group">
            <input type="checkbox" id="cityDriving" checked />
            <label for="cityDriving"
              >–í—Ä–∞—Ö–æ–≤—É–≤–∞—Ç–∏ –º—ñ—Å—å–∫–µ –≤–æ–¥—ñ–Ω–Ω—è (+15% –≤–∏—Ç—Ä–∞—Ç–∏)</label
            >
          </div>

          <button
            class="btn"
            onclick="calculateRoute()"
            style="width: 100%; margin-top: 20px"
          >
            üßÆ –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –º–∞—Ä—à—Ä—É—Ç
          </button>

          <div id="results"></div>
        </div>

        <div class="map-section">
          <div id="map"></div>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <script>
      let map;
      let routeControl;
      let markers = [];

      function initMap() {
        map = L.map("map").setView([49.8397, 24.0297], 6);

        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution: "¬© OpenStreetMap contributors",
        }).addTo(map);
      }

      function getCurrentLocation(inputId) {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            function (position) {
              const lat = position.coords.latitude;
              const lon = position.coords.longitude;

              fetch(
                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`
              )
                .then((response) => response.json())
                .then((data) => {
                  document.getElementById(inputId).value = data.display_name;
                })
                .catch((error) => {
                  console.error("–ü–æ–º–∏–ª–∫–∞ –≥–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è:", error);
                  document.getElementById(inputId).value = `${lat}, ${lon}`;
                });
            },
            function (error) {
              alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≥–µ–æ–ª–æ–∫–∞—Ü—ñ—é: " + error.message);
            }
          );
        } else {
          alert("–ì–µ–æ–ª–æ–∫–∞—Ü—ñ—è –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º");
        }
      }

      const carDatabase = {
        "toyota corolla 1.6": {
          consumption: 6.8,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.6L (122 –∫.—Å.)",
          year: "2019-2024",
        },
        "toyota corolla 1.8": {
          consumption: 7.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.8L (140 –∫.—Å.)",
          year: "2019-2024",
        },
        "toyota corolla 2.0": {
          consumption: 7.8,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L (169 –∫.—Å.)",
          year: "2019-2024",
        },
        "toyota corolla hybrid": {
          consumption: 4.5,
          engine: "–ì—ñ–±—Ä–∏–¥–Ω–∏–π 1.8L (122 –∫.—Å.)",
          year: "2019-2024",
        },

        // Toyota Camry
        "toyota camry 2.0": {
          consumption: 8.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L (150 –∫.—Å.)",
          year: "2018-2024",
        },
        "toyota camry 2.5": {
          consumption: 8.7,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.5L (181 –∫.—Å.)",
          year: "2018-2024",
        },
        "toyota camry 3.5 v6": {
          consumption: 10.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 3.5L V6 (301 –∫.—Å.)",
          year: "2018-2024",
        },

        // Toyota RAV4
        "toyota rav4 2.0": {
          consumption: 8.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L (146 –∫.—Å.)",
          year: "2019-2024",
        },
        "toyota rav4 2.5": {
          consumption: 9.4,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.5L (199 –∫.—Å.)",
          year: "2019-2024",
        },
        "toyota rav4 hybrid": {
          consumption: 5.8,
          engine: "–ì—ñ–±—Ä–∏–¥–Ω–∏–π 2.5L (218 –∫.—Å.)",
          year: "2019-2024",
        },

        // BMW 3 Series
        "bmw 318i": {
          consumption: 7.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.5L TwinPower (136 –∫.—Å.)",
          year: "2019-2024",
        },
        "bmw 320i": {
          consumption: 7.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TwinPower (184 –∫.—Å.)",
          year: "2019-2024",
        },
        "bmw 330i": {
          consumption: 8.6,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TwinPower (258 –∫.—Å.)",
          year: "2019-2024",
        },
        "bmw 340i": {
          consumption: 9.8,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 3.0L TwinPower (374 –∫.—Å.)",
          year: "2019-2024",
        },

        // BMW 5 Series
        "bmw 520i": {
          consumption: 8.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TwinPower (184 –∫.—Å.)",
          year: "2019-2024",
        },
        "bmw 530i": {
          consumption: 8.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TwinPower (252 –∫.—Å.)",
          year: "2019-2024",
        },
        "bmw 540i": {
          consumption: 10.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 3.0L TwinPower (333 –∫.—Å.)",
          year: "2019-2024",
        },

        // Mercedes C-Class
        "mercedes c180": {
          consumption: 7.3,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.6L Turbo (156 –∫.—Å.)",
          year: "2019-2024",
        },
        "mercedes c200": {
          consumption: 8.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L Turbo (184 –∫.—Å.)",
          year: "2019-2024",
        },
        "mercedes c250": {
          consumption: 8.7,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L Turbo (211 –∫.—Å.)",
          year: "2019-2024",
        },
        "mercedes c300": {
          consumption: 9.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L Turbo (255 –∫.—Å.)",
          year: "2019-2024",
        },

        // Mercedes E-Class
        "mercedes e200": {
          consumption: 8.4,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L Turbo (184 –∫.—Å.)",
          year: "2019-2024",
        },
        "mercedes e250": {
          consumption: 8.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L Turbo (211 –∫.—Å.)",
          year: "2019-2024",
        },
        "mercedes e300": {
          consumption: 9.5,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L Turbo (255 –∫.—Å.)",
          year: "2019-2024",
        },

        // Audi A3
        "audi a3 1.0 tfsi": {
          consumption: 6.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.0L TFSI (110 –∫.—Å.)",
          year: "2019-2024",
        },
        "audi a3 1.4 tfsi": {
          consumption: 6.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.4L TFSI (150 –∫.—Å.)",
          year: "2019-2024",
        },
        "audi a3 2.0 tfsi": {
          consumption: 8.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TFSI (190 –∫.—Å.)",
          year: "2019-2024",
        },

        // Audi A4
        "audi a4 1.4 tfsi": {
          consumption: 7.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.4L TFSI (150 –∫.—Å.)",
          year: "2019-2024",
        },
        "audi a4 2.0 tfsi": {
          consumption: 7.8,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TFSI (190 –∫.—Å.)",
          year: "2019-2024",
        },
        "audi a4 2.0 tfsi quattro": {
          consumption: 8.6,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TFSI Quattro (252 –∫.—Å.)",
          year: "2019-2024",
        },

        // Volkswagen Golf
        "volkswagen golf 1.0 tsi": {
          consumption: 6.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.0L TSI (110 –∫.—Å.)",
          year: "2019-2024",
        },
        "volkswagen golf 1.4 tsi": {
          consumption: 7.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.4L TSI (150 –∫.—Å.)",
          year: "2019-2024",
        },
        "volkswagen golf 1.5 tsi": {
          consumption: 7.4,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.5L TSI (150 –∫.—Å.)",
          year: "2019-2024",
        },
        "volkswagen golf 2.0 tsi": {
          consumption: 8.3,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TSI (245 –∫.—Å.)",
          year: "2019-2024",
        },

        // Honda Civic
        "honda civic 1.0 vtec turbo": {
          consumption: 6.4,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.0L VTEC Turbo (129 –∫.—Å.)",
          year: "2019-2024",
        },
        "honda civic 1.5 vtec turbo": {
          consumption: 6.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.5L VTEC Turbo (182 –∫.—Å.)",
          year: "2019-2024",
        },
        "honda civic 2.0 vtec": {
          consumption: 8.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L VTEC (158 –∫.—Å.)",
          year: "2019-2024",
        },

        // Ford Focus
        "ford focus 1.0 ecoboost": {
          consumption: 6.5,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.0L EcoBoost (125 –∫.—Å.)",
          year: "2018-2024",
        },
        "ford focus 1.5 ecoboost": {
          consumption: 7.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.5L EcoBoost (150 –∫.—Å.)",
          year: "2018-2024",
        },
        "ford focus 2.0 ecoboost": {
          consumption: 8.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L EcoBoost (252 –∫.—Å.)",
          year: "2018-2024",
        },

        // Hyundai Elantra
        "hyundai elantra 1.6": {
          consumption: 6.8,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.6L MPI (123 –∫.—Å.)",
          year: "2019-2024",
        },
        "hyundai elantra 1.6 turbo": {
          consumption: 7.4,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.6L Turbo (201 –∫.—Å.)",
          year: "2019-2024",
        },
        "hyundai elantra 2.0": {
          consumption: 8.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L MPI (149 –∫.—Å.)",
          year: "2019-2024",
        },

        // Kia Rio
        "kia rio 1.25": {
          consumption: 5.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.25L MPI (84 –∫.—Å.)",
          year: "2017-2024",
        },
        "kia rio 1.4": {
          consumption: 6.4,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.4L MPI (100 –∫.—Å.)",
          year: "2017-2024",
        },
        "kia rio 1.6": {
          consumption: 7.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.6L MPI (123 –∫.—Å.)",
          year: "2017-2024",
        },

        // Skoda Octavia
        "skoda octavia 1.0 tsi": {
          consumption: 6.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.0L TSI (110 –∫.—Å.)",
          year: "2019-2024",
        },
        "skoda octavia 1.4 tsi": {
          consumption: 6.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.4L TSI (150 –∫.—Å.)",
          year: "2019-2024",
        },
        "skoda octavia 1.5 tsi": {
          consumption: 7.3,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.5L TSI (150 –∫.—Å.)",
          year: "2019-2024",
        },
        "skoda octavia 2.0 tsi": {
          consumption: 8.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TSI (190 –∫.—Å.)",
          year: "2019-2024",
        },

        // Mazda 3
        "mazda 3 1.5 skyactiv": {
          consumption: 6.4,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.5L SKYACTIV (120 –∫.—Å.)",
          year: "2019-2024",
        },
        "mazda 3 2.0 skyactiv": {
          consumption: 7.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L SKYACTIV (165 –∫.—Å.)",
          year: "2019-2024",
        },
        "mazda 3 2.5 skyactiv": {
          consumption: 8.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.5L SKYACTIV (194 –∫.—Å.)",
          year: "2019-2024",
        },

        // Nissan Sentra
        "nissan sentra 1.6": {
          consumption: 6.9,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.6L (124 –∫.—Å.)",
          year: "2019-2024",
        },
        "nissan sentra 1.8": {
          consumption: 7.6,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 1.8L (130 –∫.—Å.)",
          year: "2019-2024",
        },

        // –ü–æ–ø—É–ª—è—Ä–Ω—ñ SUV –∑ —Ä—ñ–∑–Ω–∏–º–∏ –¥–≤–∏–≥—É–Ω–∞–º–∏
        "bmw x3 2.0": {
          consumption: 9.4,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TwinPower (184 –∫.—Å.)",
          year: "2019-2024",
        },
        "bmw x3 3.0": {
          consumption: 11.2,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 3.0L TwinPower (382 –∫.—Å.)",
          year: "2019-2024",
        },

        "mercedes glc 200": {
          consumption: 8.8,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L Turbo (184 –∫.—Å.)",
          year: "2019-2024",
        },
        "mercedes glc 300": {
          consumption: 9.8,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L Turbo (255 –∫.—Å.)",
          year: "2019-2024",
        },

        "audi q5 2.0 tfsi": {
          consumption: 9.1,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 2.0L TFSI (252 –∫.—Å.)",
          year: "2019-2024",
        },
        "audi q5 3.0 tfsi": {
          consumption: 10.8,
          engine: "–ë–µ–Ω–∑–∏–Ω–æ–≤–∏–π 3.0L TFSI (354 –∫.—Å.)",
          year: "2019-2024",
        },

        // –î–∏–∑–µ–ª—å–Ω—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏
        "bmw 320d": {
          consumption: 5.8,
          engine: "–î–∏–∑–µ–ª—å–Ω–∏–π 2.0L (190 –∫.—Å.)",
          year: "2019-2024",
        },
        "mercedes c220d": {
          consumption: 5.9,
          engine: "–î–∏–∑–µ–ª—å–Ω–∏–π 2.0L (194 –∫.—Å.)",
          year: "2019-2024",
        },
        "audi a4 2.0 tdi": {
          consumption: 5.6,
          engine: "–î–∏–∑–µ–ª—å–Ω–∏–π 2.0L TDI (190 –∫.—Å.)",
          year: "2019-2024",
        },
        "volkswagen golf 2.0 tdi": {
          consumption: 5.2,
          engine: "–î–∏–∑–µ–ª—å–Ω–∏–π 2.0L TDI (150 –∫.—Å.)",
          year: "2019-2024",
        },
      };

      // –ü–æ—à—É–∫ –¥–∞–Ω–∏—Ö –ø—Ä–æ –∞–≤—Ç–æ–º–æ–±—ñ–ª—å –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–æ—é –±–∞–∑–æ—é
      async function searchCarData() {
        const carModel = document.getElementById("carModel").value.trim();
        if (!carModel) {
          // –Ø–∫—â–æ –ø–æ–ª–µ –ø–æ—Ä–æ–∂–Ω—î, –ø—Ä–æ—Å—Ç–æ –æ—á–∏—â–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
          document.getElementById("results").innerHTML = "";
          return;
        }

        const loading = document.createElement("div");
        loading.className = "loading";
        loading.innerHTML =
          '<div class="spinner"></div>–®—É–∫–∞—î–º–æ –¥–∞–Ω—ñ –ø—Ä–æ –∞–≤—Ç–æ–º–æ–±—ñ–ª—å...';
        document.getElementById("results").innerHTML = "";
        document.getElementById("results").appendChild(loading);

        try {
          await new Promise((resolve) => setTimeout(resolve, 800)); // –Ü–º—ñ—Ç–∞—Ü—ñ—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è

          const fuelData = findCarInDatabase(carModel);

          if (fuelData) {
            document.getElementById("fuelConsumption").value =
              fuelData.consumption;
            document.getElementById("results").innerHTML = `
                        <div class="results show">
                            <h3>‚úÖ –ó–Ω–∞–π–¥–µ–Ω–æ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö</h3>
                            <div class="result-item">
                                <span>–°–µ—Ä–µ–¥–Ω—è –≤–∏—Ç—Ä–∞—Ç–∞:</span>
                                <span><strong>${fuelData.consumption} –ª/100–∫–º</strong></span>
                            </div>
                            <div class="result-item">
                                <span>–¢–∏–ø –¥–≤–∏–≥—É–Ω–∞:</span>
                                <span>${fuelData.engine}</span>
                            </div>
                            <div class="result-item">
                                <span>–†–æ–∫–∏ –≤–∏–ø—É—Å–∫—É:</span>
                                <span>${fuelData.year}</span>
                            </div>
                        </div>
                    `;
          } else {
            // –ü—Ä–æ–±—É—î–º–æ –∑–Ω–∞–π—Ç–∏ —Å—Ö–æ–∂—ñ –º–æ–¥–µ–ª—ñ
            const suggestions = findSimilarCars(carModel);
            let suggestionText = "";

            if (suggestions.length > 0) {
              suggestionText = `<div style="margin-top: 15px; font-size: 0.9rem;">
                            <strong>–ú–æ–∂–ª–∏–≤–æ, –≤–∏ –º–∞–ª–∏ –Ω–∞ —É–≤–∞–∑—ñ:</strong><br>
                            ${suggestions
                              .slice(0, 3)
                              .map(
                                (s) => `‚Ä¢ ${s.name} (${s.consumption} –ª/100–∫–º)`
                              )
                              .join("<br>")}
                        </div>`;
            }

            document.getElementById("results").innerHTML = `
                        <div class="error">
                            ‚ùå –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ —Ç–æ—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö –¥–ª—è "${carModel}". 
                            <br>–í–≤–µ–¥—ñ—Ç—å –≤–∏—Ç—Ä–∞—Ç—É –ø–∞–ª–∏–≤–∞ –≤—Ä—É—á–Ω—É –∞–±–æ —Å–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à–∏–π –∑–∞–ø–∏—Ç.
                            ${suggestionText}
                        </div>
                    `;
          }
        } catch (error) {
          document.getElementById("results").innerHTML = `
                    <div class="error">
                        ‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–æ—à—É–∫—É: ${error.message}
                    </div>
                `;
        }
      }

      // –ü–æ—à—É–∫ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö –∑ —Ä–æ–∑—É–º–Ω–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º
      function findCarInDatabase(searchQuery) {
        const query = searchQuery.toLowerCase().trim();

        // –ü—Ä—è–º–µ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è
        if (carDatabase[query]) {
          return carDatabase[query];
        }

        // –ü–æ—à—É–∫ –ø–æ —á–∞—Å—Ç–∏–Ω–∞—Ö (–º–∞—Ä–∫–∞ + –º–æ–¥–µ–ª—å)
        for (const key in carDatabase) {
          const keyWords = key.split(" ");
          const queryWords = query.split(" ");

          // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –º—ñ—Å—Ç–∏—Ç—å –∑–∞–ø–∏—Ç –æ—Å–Ω–æ–≤–Ω—ñ —Å–ª–æ–≤–∞ –∑ –∫–ª—é—á–∞
          let matches = 0;
          for (const keyWord of keyWords) {
            for (const queryWord of queryWords) {
              if (queryWord.includes(keyWord) || keyWord.includes(queryWord)) {
                matches++;
                break;
              }
            }
          }

          // –Ø–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è –ø–æ –≤—Å—ñ—Ö –æ—Å–Ω–æ–≤–Ω–∏—Ö —Å–ª–æ–≤–∞—Ö
          if (matches >= keyWords.length) {
            return carDatabase[key];
          }
        }

        return null;
      }

      // –ü–æ—à—É–∫ —Å—Ö–æ–∂–∏—Ö –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤ –¥–ª—è –ø—ñ–¥–∫–∞–∑–æ–∫
      function findSimilarCars(searchQuery) {
        const query = searchQuery.toLowerCase().trim();
        const suggestions = [];

        for (const key in carDatabase) {
          const keyWords = key.split(" ");
          const queryWords = query.split(" ");

          // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∞—Å—Ç–∫–æ–≤—ñ —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω–Ω—è
          let partialMatches = 0;
          for (const keyWord of keyWords) {
            for (const queryWord of queryWords) {
              if (keyWord.includes(queryWord) || queryWord.includes(keyWord)) {
                partialMatches++;
                break;
              }
            }
          }

          if (partialMatches > 0) {
            suggestions.push({
              name: key
                .split(" ")
                .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
                .join(" "),
              consumption: carDatabase[key].consumption,
              matches: partialMatches,
            });
          }
        }

        // –°–æ—Ä—Ç—É—î–º–æ –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Å–ø—ñ–≤–ø–∞–¥—ñ–Ω—å
        return suggestions.sort((a, b) => b.matches - a.matches);
      }

      // –ì–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è –∞–¥—Ä–µ—Å–∏
      async function geocodeAddress(address) {
        const response = await fetch(
          `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(
            address
          )}&limit=1`
        );
        const data = await response.json();
        if (data.length === 0) {
          throw new Error(`–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∞–¥—Ä–µ—Å—É: ${address}`);
        }
        return {
          lat: parseFloat(data[0].lat),
          lon: parseFloat(data[0].lon),
          display_name: data[0].display_name,
        };
      }

      // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –º–∞—Ä—à—Ä—É—Ç—É –∑ —Ä–µ–∞–ª—å–Ω–æ—é –≤—ñ–¥—Å—Ç–∞–Ω–Ω—é
      async function calculateRoute() {
        const from = document.getElementById("from").value;
        const to = document.getElementById("to").value;
        const fuelConsumption = parseFloat(
          document.getElementById("fuelConsumption").value
        );
        const fuelPrice = parseFloat(
          document.getElementById("fuelPrice").value
        );
        const cityDriving = document.getElementById("cityDriving").checked;

        if (!from || !to) {
          alert("–í–≤–µ–¥—ñ—Ç—å –ø–æ—á–∞—Ç–∫–æ–≤—É —Ç–∞ –∫—ñ–Ω—Ü–µ–≤—É —Ç–æ—á–∫–∏");
          return;
        }

        if (!fuelConsumption || !fuelPrice) {
          alert("–í–≤–µ–¥—ñ—Ç—å –≤–∏—Ç—Ä–∞—Ç—É –ø–∞–ª–∏–≤–∞ —Ç–∞ —Ü—ñ–Ω—É");
          return;
        }

        const loading = document.createElement("div");
        loading.className = "loading";
        loading.innerHTML =
          '<div class="spinner"></div>–†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ —Ä–µ–∞–ª—å–Ω–∏–π –∞–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç...';
        document.getElementById("results").innerHTML = "";
        document.getElementById("results").appendChild(loading);

        try {
          // –ì–µ–æ–∫–æ–¥—É–≤–∞–Ω–Ω—è –∞–¥—Ä–µ—Å
          const fromCoords = await geocodeAddress(from);
          const toCoords = await geocodeAddress(to);

          // –û—á–∏—â–µ–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –º–∞—Ä–∫–µ—Ä—ñ–≤ —ñ –º–∞—Ä—à—Ä—É—Ç—ñ–≤
          markers.forEach((marker) => map.removeLayer(marker));
          markers = [];

          if (routeControl) {
            map.removeControl(routeControl);
          }

          // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É –∑ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è–º —Ä–µ–∞–ª—å–Ω–æ—ó –≤—ñ–¥—Å—Ç–∞–Ω—ñ
          const routePromise = new Promise((resolve, reject) => {
            routeControl = L.Routing.control({
              waypoints: [
                L.latLng(fromCoords.lat, fromCoords.lon),
                L.latLng(toCoords.lat, toCoords.lon),
              ],
              routeWhileDragging: false,
              addWaypoints: false,
              createMarker: function () {
                return null;
              },
              lineOptions: {
                styles: [{ color: "#27ae60", weight: 5, opacity: 0.8 }],
              },
            })
              .on("routesfound", function (e) {
                const routes = e.routes;
                const route = routes[0];
                const distance = route.summary.totalDistance / 1000; // –∫–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –º–µ—Ç—Ä–∏ –≤ –∫—ñ–ª–æ–º–µ—Ç—Ä–∏
                resolve(distance);
              })
              .on("routingerror", function (e) {
                reject(new Error("–ù–µ –≤–¥–∞–ª–æ—Å—è –ø–æ–±—É–¥—É–≤–∞—Ç–∏ –º–∞—Ä—à—Ä—É—Ç"));
              })
              .addTo(map);
          });

          // –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤–ª–∞—Å–Ω–∏—Ö –º–∞—Ä–∫–µ—Ä—ñ–≤
          const startMarker = L.marker([fromCoords.lat, fromCoords.lon])
            .addTo(map)
            .bindPopup(`üöÄ –ü–æ—á–∞—Ç–æ–∫: ${fromCoords.display_name}`);

          const endMarker = L.marker([toCoords.lat, toCoords.lon])
            .addTo(map)
            .bindPopup(`üèÅ –ö—ñ–Ω–µ—Ü—å: ${toCoords.display_name}`);

          markers.push(startMarker, endMarker);

          // –ß–µ–∫–∞—î–º–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–æ—ó –≤—ñ–¥—Å—Ç–∞–Ω—ñ –º–∞—Ä—à—Ä—É—Ç—É
          const realDistance = await routePromise;

          // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤–∏—Ç—Ä–∞—Ç –∑ —Ä–µ–∞–ª—å–Ω–æ—é –≤—ñ–¥—Å—Ç–∞–Ω–Ω—é
          let adjustedConsumption = fuelConsumption;
          if (cityDriving) {
            adjustedConsumption *= 1.15; // +15% –¥–ª—è –º—ñ—Å—å–∫–æ–≥–æ –≤–æ–¥—ñ–Ω–Ω—è
          }

          const fuelNeeded = (realDistance * adjustedConsumption) / 100;
          const totalCost = fuelNeeded * fuelPrice;
          const estimatedTime = Math.round((realDistance / 80) * 60); // –ü—Ä–∏–±–ª–∏–∑–Ω–∏–π —á–∞—Å (80 –∫–º/–≥–æ–¥ —Å–µ—Ä–µ–¥–Ω—è —à–≤–∏–¥–∫—ñ—Å—Ç—å)

          // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
          document.getElementById("results").innerHTML = `
                    <div class="results show">
                        <h3>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É</h3>
                        <div class="result-item">
                            <span>–†–µ–∞–ª—å–Ω–∞ –≤—ñ–¥—Å—Ç–∞–Ω—å –º–∞—Ä—à—Ä—É—Ç—É:</span>
                            <span><strong>${realDistance.toFixed(
                              1
                            )} –∫–º</strong></span>
                        </div>
                        <div class="result-item">
                            <span>–û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∏–π —á–∞—Å –≤ –¥–æ—Ä–æ–∑—ñ:</span>
                            <span>${Math.floor(estimatedTime / 60)} –≥–æ–¥ ${
            estimatedTime % 60
          } —Ö–≤</span>
                        </div>
                        <div class="result-item">
                            <span>–í–∏—Ç—Ä–∞—Ç–∞ –ø–∞–ª–∏–≤–∞:</span>
                            <span><strong>${fuelNeeded.toFixed(
                              1
                            )} –ª</strong></span>
                        </div>
                        <div class="result-item">
                            <span>–ó–∞–≥–∞–ª—å–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å –ø–∞–ª–∏–≤–∞:</span>
                            <span><strong>${totalCost.toFixed(
                              0
                            )} –≥—Ä–Ω</strong></span>
                        </div>
                        ${
                          cityDriving
                            ? '<div style="font-size: 0.9rem; opacity: 0.9; margin-top: 10px;">* –í—Ä–∞—Ö–æ–≤–∞–Ω–æ +15% –¥–ª—è –º—ñ—Å—å–∫–æ–≥–æ –≤–æ–¥—ñ–Ω–Ω—è</div>'
                            : ""
                        }
                    </div>
                `;

          // –¶–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è –∫–∞—Ä—Ç–∏ –Ω–∞ –º–∞—Ä—à—Ä—É—Ç—ñ
          setTimeout(() => {
            const group = new L.featureGroup(markers);
            map.fitBounds(group.getBounds().pad(0.1));
          }, 1000);
        } catch (error) {
          document.getElementById("results").innerHTML = `
                    <div class="error">
                        ‚ùå –ü–æ–º–∏–ª–∫–∞: ${error.message}
                    </div>
                `;
        }
      }

      // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤—ñ–¥—Å—Ç–∞–Ω—ñ –º—ñ–∂ –¥–≤–æ–º–∞ —Ç–æ—á–∫–∞–º–∏ (Haversine formula)
      function calculateDistance(lat1, lon1, lat2, lon2) {
        const R = 6371; // –†–∞–¥—ñ—É—Å –ó–µ–º–ª—ñ –≤ –∫–º
        const dLat = ((lat2 - lat1) * Math.PI) / 180;
        const dLon = ((lon2 - lon1) * Math.PI) / 180;
        const a =
          Math.sin(dLat / 2) * Math.sin(dLat / 2) +
          Math.cos((lat1 * Math.PI) / 180) *
            Math.cos((lat2 * Math.PI) / 180) *
            Math.sin(dLon / 2) *
            Math.sin(dLon / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        return R * c;
      }

      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
      document.addEventListener("DOMContentLoaded", function () {
        initMap();

        // –ê–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–ª—è –ø–æ–ª—ñ–≤ –∞–¥—Ä–µ—Å
        setupAddressAutocomplete("from");
        setupAddressAutocomplete("to");

        // –ê–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–ª—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤
        setupCarAutocomplete();
      });

      // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–ª—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤
      function setupCarAutocomplete() {
        const input = document.getElementById("carModel");
        const suggestionsDiv = document.getElementById("carSuggestions");
        const searchBtn = document.getElementById("searchBtn");
        let timeout;

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ –∫–Ω–æ–ø–∫–∏
        function updateSearchButtonVisibility() {
          if (input.value.trim().length > 0) {
            searchBtn.style.display = "block";
          } else {
            searchBtn.style.display = "none";
            suggestionsDiv.style.display = "none";
          }
        }

        // –ü–æ—á–∞—Ç–∫–æ–≤–µ –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∏
        updateSearchButtonVisibility();

        input.addEventListener("input", function () {
          clearTimeout(timeout);
          const query = this.value.trim();

          updateSearchButtonVisibility();

          if (query.length < 2) {
            suggestionsDiv.style.display = "none";
            return;
          }

          timeout = setTimeout(() => {
            const suggestions = getCarSuggestions(query);
            displayCarSuggestions(suggestions, suggestionsDiv);
          }, 300);
        });

        // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –ø—ñ–¥–∫–∞–∑–∫–∏ –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –ø–æ–ª–µ–º
        document.addEventListener("click", function (e) {
          if (
            !e.target.closest("#carModel") &&
            !e.target.closest("#carSuggestions")
          ) {
            suggestionsDiv.style.display = "none";
          }
        });

        // –ü—Ä–∏—Ö–æ–≤—É—î–º–æ –ø—ñ–¥–∫–∞–∑–∫–∏ –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ Escape
        input.addEventListener("keydown", function (e) {
          if (e.key === "Escape") {
            suggestionsDiv.style.display = "none";
          }
        });
      }

      // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—ñ–¥–∫–∞–∑–æ–∫ –¥–ª—è –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤
      function getCarSuggestions(query) {
        const suggestions = [];
        const queryLower = query.toLowerCase();

        for (const key in carDatabase) {
          const carName = key
            .split(" ")
            .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
            .join(" ");

          if (key.toLowerCase().includes(queryLower)) {
            suggestions.push({
              key: key,
              name: carName,
              ...carDatabase[key],
            });
          }

          if (suggestions.length >= 8) break; // –û–±–º–µ–∂—É—î–º–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—ñ–¥–∫–∞–∑–æ–∫
        }

        return suggestions;
      }

      // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—ñ–¥–∫–∞–∑–æ–∫ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤
      function displayCarSuggestions(suggestions, container) {
        if (suggestions.length === 0) {
          container.style.display = "none";
          return;
        }

        container.innerHTML = suggestions
          .map(
            (suggestion) => `
                <div class="suggestion-item" onclick="selectCarSuggestion('${suggestion.key}', '${suggestion.name}', ${suggestion.consumption})">
                    <div class="suggestion-main">${suggestion.name}</div>
                    <div class="suggestion-details">${suggestion.consumption} –ª/100–∫–º ‚Ä¢ ${suggestion.engine}</div>
                </div>
            `
          )
          .join("");

        container.style.display = "block";
      }

      // –í–∏–±—ñ—Ä –ø—ñ–¥–∫–∞–∑–∫–∏ –∞–≤—Ç–æ–º–æ–±—ñ–ª—è
      function selectCarSuggestion(key, name, consumption) {
        document.getElementById("carModel").value = name;
        document.getElementById("fuelConsumption").value = consumption;
        document.getElementById("carSuggestions").style.display = "none";

        // –ü–æ–∫–∞–∑—É—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –≤–∏–±—Ä–∞–Ω–∏–π –∞–≤—Ç–æ–º–æ–±—ñ–ª—å
        const carData = carDatabase[key];
        document.getElementById("results").innerHTML = `
                <div class="results show">
                    <h3>‚úÖ –ê–≤—Ç–æ–º–æ–±—ñ–ª—å –≤–∏–±—Ä–∞–Ω–æ</h3>
                    <div class="result-item">
                        <span>–ú–æ–¥–µ–ª—å:</span>
                        <span><strong>${name}</strong></span>
                    </div>
                    <div class="result-item">
                        <span>–í–∏—Ç—Ä–∞—Ç–∞ –ø–∞–ª–∏–≤–∞:</span>
                        <span><strong>${consumption} –ª/100–∫–º</strong></span>
                    </div>
                    <div class="result-item">
                        <span>–î–≤–∏–≥—É–Ω:</span>
                        <span>${carData.engine}</span>
                    </div>
                    <div class="result-item">
                        <span>–†–æ–∫–∏:</span>
                        <span>${carData.year}</span>
                    </div>
                </div>
            `;
      }

      // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–≤—Ç–æ–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–ª—è –∞–¥—Ä–µ—Å
      function setupAddressAutocomplete(inputId) {
        const input = document.getElementById(inputId);
        let timeout;

        input.addEventListener("input", function () {
          clearTimeout(timeout);
          const query = this.value.trim();

          if (query.length < 3) return;

          timeout = setTimeout(async () => {
            try {
              // –ü–æ–∫–∞–∑—É—î–º–æ –º—ñ—Ç–∫—É –Ω–∞ –∫–∞—Ä—Ç—ñ –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è
              await showLocationOnMap(query, inputId);
            } catch (error) {
              console.log("–ü–æ–º–∏–ª–∫–∞ –ø–æ—à—É–∫—É –ª–æ–∫–∞—Ü—ñ—ó:", error);
            }
          }, 1000);
        });
      }

      // –ü–æ–∫–∞–∑ –ª–æ–∫–∞—Ü—ñ—ó –Ω–∞ –∫–∞—Ä—Ç—ñ
      async function showLocationOnMap(address, inputId) {
        try {
          const coords = await geocodeAddress(address);

          // –í–∏–¥–∞–ª—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—é –º—ñ—Ç–∫—É –¥–ª—è —Ü—å–æ–≥–æ –ø–æ–ª—è
          markers = markers.filter((marker) => {
            if (marker.options.inputId === inputId) {
              map.removeLayer(marker);
              return false;
            }
            return true;
          });

          // –î–æ–¥–∞—î–º–æ –Ω–æ–≤—É –º—ñ—Ç–∫—É
          const icon = inputId === "from" ? "üöÄ" : "üèÅ";
          const popup =
            inputId === "from" ? "–ü–æ—á–∞—Ç–æ–∫ –º–∞—Ä—à—Ä—É—Ç—É" : "–ö—ñ–Ω–µ—Ü—å –º–∞—Ä—à—Ä—É—Ç—É";

          const marker = L.marker([coords.lat, coords.lon], {
            inputId: inputId,
          })
            .addTo(map)
            .bindPopup(
              `${icon} ${popup}<br><small>${coords.display_name}</small>`
            );

          markers.push(marker);

          // –¶–µ–Ω—Ç—Ä—É—î–º–æ –∫–∞—Ä—Ç—É –Ω–∞ –Ω–æ–≤—ñ–π –º—ñ—Ç—Ü—ñ
          map.setView([coords.lat, coords.lon], 12);

          // –Ø–∫—â–æ –æ–±–∏–¥–≤—ñ –º—ñ—Ç–∫–∏ —î, –ø–æ–∫–∞–∑—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –º–∞—Ä—à—Ä—É—Ç
          const fromMarker = markers.find((m) => m.options.inputId === "from");
          const toMarker = markers.find((m) => m.options.inputId === "to");

          if (
            fromMarker &&
            toMarker &&
            document.getElementById("from").value &&
            document.getElementById("to").value
          ) {
            showPreviewRoute(fromMarker.getLatLng(), toMarker.getLatLng());
          }
        } catch (error) {
          console.log("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–Ω–∞–π—Ç–∏ –ª–æ–∫–∞—Ü—ñ—é:", address);
        }
      }

      // –ü–æ–∫–∞–∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É
      function showPreviewRoute(fromLatLng, toLatLng) {
        // –í–∏–¥–∞–ª—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∫–æ–Ω—Ç—Ä–æ–ª –º–∞—Ä—à—Ä—É—Ç—É
        if (routeControl) {
          map.removeControl(routeControl);
        }

        // –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π –º–∞—Ä—à—Ä—É—Ç
        routeControl = L.Routing.control({
          waypoints: [fromLatLng, toLatLng],
          routeWhileDragging: false,
          addWaypoints: false,
          createMarker: function () {
            return null;
          }, // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –≤–ª–∞—Å–Ω—ñ –º–∞—Ä–∫–µ—Ä–∏
          lineOptions: {
            styles: [{ color: "#667eea", weight: 4, opacity: 0.7 }],
          },
        }).addTo(map);

        // –ü—ñ–¥–≥–∞–Ω—è—î–º–æ –∫–∞—Ä—Ç—É –ø—ñ–¥ –º–∞—Ä—à—Ä—É—Ç
        setTimeout(() => {
          const group = new L.featureGroup(markers);
          map.fitBounds(group.getBounds().pad(0.1));
        }, 500);
      }
    </script>

    <!-- Leaflet Routing Machine -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-routing-machine/3.2.12/leaflet-routing-machine.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-routing-machine/3.2.12/leaflet-routing-machine.css"
    />
  </body>
</html>
